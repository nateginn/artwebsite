<!-- acceleratedrehabtherapy\templates\includes\_locations_map.html -->

{% load static %}

<div class="bg-[#012E47] text-white py-6">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-4xl font-bold text-center mb-12 text-white">
            MAKE AN APPOINTMENT TODAY
        </h2>
        
        <div class="grid md:grid-cols-2 gap-8 mb-8">
            <!-- Greeley Location Card -->
            <div id="greeley-card" class="bg-[#236E8C] border-2 border-gray-700 rounded-lg p-6 transition-all duration-300 flex flex-col justify-between h-full">
                <div class="mb-4">
                    <h3 class="text-2xl font-bold text-yellow-400">GREELEY</h3>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mt-1 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <p class="text-gray-300">2928 W 10th St Greeley, CO 80634</p>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                        <a href="mailto:greeleyrehab@gmail.com" class="text-gray-300 hover:text-yellow-400">greeleyrehab@gmail.com</a>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                        </svg>
                        <a href="tel:970-324-1750" class="text-gray-300 hover:text-yellow-400">970-324-1750</a>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="showLocation('greeley')" id="greeley-button" class="flex-1 py-3 px-6 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                            On Map
                        </button>
                        <a href="https://maps.google.com/maps?daddr=40.422457,-104.728624&z=15" 
                           class="flex-1 py-3 px-6 bg-yellow-400 text-gray-900 rounded-lg hover:bg-yellow-500 transition-colors text-center" 
                           target="_blank">
                            Get Directions
                        </a>
                    </div>
                </div>
            </div>

            <!-- Fort Collins Location Card -->
            <div id="fortCollins-card" class="bg-[#236E8C] border-2 border-gray-700 rounded-lg p-6 transition-all duration-300 flex flex-col justify-between h-full">
                <div class="mb-4">
                    <h3 class="text-2xl font-bold text-yellow-400">FORT COLLINS</h3>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mt-1 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <p class="text-gray-300">105 Coronado Ct. STE B-102 Fort Collins, CO 80525</p>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                        <a href="mailto:greeleyrehab@gmail.com" class="text-gray-300 hover:text-yellow-400">greeleyrehab@gmail.com</a>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                        </svg>
                        <a href="tel:970-324-1750" class="text-gray-300 hover:text-yellow-400">970-324-1750</a>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="showLocation('fortCollins')" id="fortCollins-button" class="flex-1 py-3 px-6 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                            On Map
                        </button>
                        <a href="https://maps.google.com/maps?daddr=40.515392,-105.078325&z=15" 
                           class="flex-1 py-3 px-6 bg-yellow-400 text-gray-900 rounded-lg hover:bg-yellow-500 transition-colors text-center" 
                           target="_blank">
                            Get Directions
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="w-full h-96 bg-white rounded-lg overflow-hidden">
            <div class="w-full h-full" id="map"></div>
        </div>
    </div>
</div>

<!-- Google Maps Script -->
<script>
let map;
let markers = {};
let activeLocation = null;

const locations = {
    greeley: { 
        coords: { lat: 40.422457, lng: -104.728624 },
        title: 'GREELEY',
        address: '2928 W 10th St Greeley, CO 80634',
        phone: '970-324-1750'
    },
    fortCollins: { 
        coords: { lat: 40.515392, lng: -105.078325 },
        title: 'FORT COLLINS',
        address: '105 Coronado Ct. STE B-102 Fort Collins, CO 80525',
        phone: '970-324-1750'
    }
};

function initMap() {
    const bounds = new google.maps.LatLngBounds();
    
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: 11,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        styles: [
            {
                "featureType": "all",
                "elementType": "geometry",
                "stylers": [{ "color": "#f5f5f5" }]
            },
            {
                "featureType": "water",
                "elementType": "geometry",
                "stylers": [{ "color": "#c9c9c9" }]
            },
            {
                "featureType": "road",
                "elementType": "geometry.stroke",
                "stylers": [{ "color": "#dadada" }]
            },
            {
                "featureType": "road",
                "elementType": "geometry.fill",
                "stylers": [{ "color": "#ffffff" }]
            },
            {
                "featureType": "poi",
                "elementType": "geometry",
                "stylers": [{ "color": "#eeeeee" }]
            },
            {
                "featureType": "administrative",
                "elementType": "labels.text.fill",
                "stylers": [{ "color": "#333333" }]
            }
        ]
    });

    // Add markers for each location
    Object.entries(locations).forEach(([key, location]) => {
        const marker = new google.maps.Marker({
            position: location.coords,
            map: map,
            title: location.title,
            icon: {
                url: "{% static 'img/pin.png' %}",
                scaledSize: new google.maps.Size(40, 40)
            }
        });
        
        const infoWindowContent = `
          <div style="background-color: #facc15; color: black; padding: 1px; border-radius: 5px; min-width: 20px; text-align: center;">
            <h3 style="margin: 0 0 5px 0; color: black; font-size: 28px;">${location.title}</h3>
            <p style="margin: 0 0 5px 0;font-size: 16px;font-weight: bold;">${location.address}</p>
            <button onclick="window.open('https://www.google.com/maps/dir/?api=1&destination=${location.coords.lat},${location.coords.lng}', '_blank')" 
                    style="background-color: #F55C35; color: white; border: white; padding: 1px 25px; border-radius: 5px; cursor: pointer; font-size: 24px;font-weight: bold;">
              Get Directions
            </button>
          </div>
        `;
        
        const infoWindow = new google.maps.InfoWindow({
            content: infoWindowContent,
            maxWidth: 300
        });
        
        marker.addListener('click', () => {
            showLocation(key);
        });
        
        markers[key] = {
            marker: marker,
            infoWindow: infoWindow
        };
        bounds.extend(location.coords);
    });
    
    map.fitBounds(bounds);
    
    // Set Greeley as default selected location
    setTimeout(() => {
        showLocation('greeley');
    }, 100);
}

function showLocation(location) {
    // Reset previous active location
    if (activeLocation) {
        document.getElementById(`${activeLocation}-card`).classList.remove('border-yellow-400');
        document.getElementById(`${activeLocation}-card`).classList.add('border-gray-700');
        document.getElementById(`${activeLocation}-button`).classList.remove('bg-yellow-400', 'text-gray-900', 'hover:bg-yellow-500');
        document.getElementById(`${activeLocation}-button`).classList.add('bg-gray-700', 'text-white', 'hover:bg-gray-600');
        if (markers[activeLocation].infoWindow) {
            markers[activeLocation].infoWindow.close();
        }
    }

    // Activate new location
    activeLocation = location;
    document.getElementById(`${location}-card`).classList.remove('border-gray-700');
    document.getElementById(`${location}-card`).classList.add('border-yellow-400');
    document.getElementById(`${location}-button`).classList.remove('bg-gray-700', 'text-white', 'hover:bg-gray-600');
    document.getElementById(`${location}-button`).classList.add('bg-yellow-400', 'text-gray-900', 'hover:bg-yellow-500');

    // Update map
    if (map && locations[location]) {
        map.panTo(locations[location].coords);
        map.setZoom(15);
        markers[location].infoWindow.open(map, markers[location].marker);
    }
}
</script>

<script async defer
    src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap">
</script>